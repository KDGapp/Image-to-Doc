<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%230ea5e9' stroke-width='1.5'><path stroke-linecap='round' stroke-linejoin='round' d='M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z' /><path stroke-linecap='round' stroke-linejoin='round' d='M8 10l2-2 2 2 2.5-2.5' /><circle cx='15.5' cy='8' r='1.5' /><path stroke-linecap='round' stroke-linejoin='round' d='M5 13h14' /><path stroke-linecap='round' stroke-linejoin='round' d='M8 15.5h8M8 18h5' /></svg>" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image to Doc</title>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Image to Doc",
      "description": "Instantly convert your images to editable documents. This AI-powered tool extracts text from images, describes image content, and translates text. Results can be edited and exported to various document formats.",
      "applicationCategory": "ProductivityApplication",
      "operatingSystem": "All",
      "browserRequirements": "Requires HTML5 support",
      "logo": "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%230ea5e9' stroke-width='1.5'><path stroke-linecap='round' stroke-linejoin='round' d='M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z' /><path stroke-linecap='round' stroke-linejoin='round' d='M8 10l2-2 2 2 2.5-2.5' /><circle cx='15.5' cy='8' r='1.5' /><path stroke-linecap='round' stroke-linejoin='round' d='M5 13h14' /><path stroke-linecap='round' stroke-linejoin='round' d='M8 15.5h8M8 18h5' /></svg>"
    }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <style>
      .font-orbitron {
        font-family: 'Orbitron', sans-serif;
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.20.0",
    "react-dom/": "https://esm.sh/react-dom@18.2.0/",
    "react/": "https://esm.sh/react@18.2.0/"
  }
}
</script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
  <body class="bg-gradient-to-br from-purple-100 via-blue-100 to-cyan-100 text-slate-800">
    <div id="root"></div>
    <script>
      // Polyfill process.env for browser environments to prevent crashing.
      // The Gemini service will then handle the missing API key gracefully.
      if (typeof process === 'undefined') {
        window.process = { env: { API_KEY: '' } };
      }
    </script>
    <script type="text/babel" data-presets="react,typescript" data-type="module">
// BUNDLED APPLICATION CODE

// Import dependencies from importmap
import React from 'react';
import ReactDOM from 'react-dom/client';
import { GoogleGenAI } from "@google/genai";

const { useState, useCallback, useEffect, useRef } = React;

// === START: types.ts ===
var AppState;
(function (AppState) {
    AppState[AppState["IDLE"] = 0] = "IDLE";
    AppState[AppState["TASK_SELECTION"] = 1] = "TASK_SELECTION";
    AppState[AppState["PROCESSING"] = 2] = "PROCESSING";
    AppState[AppState["SUCCESS"] = 3] = "SUCCESS";
    AppState[AppState["ERROR"] = 4] = "ERROR";
    AppState[AppState["API_KEY_NEEDED"] = 5] = "API_KEY_NEEDED";
})(AppState || (AppState = {}));
var Task;
(function (Task) {
    Task["EXTRACT_TEXT"] = "Extract Text";
    Task["DESCRIBE_IMAGE"] = "Describe Image";
    Task["TRANSLATE"] = "Translate Text in Image";
})(Task || (Task = {}));
// === END: types.ts ===

// === START: utils/fileUtils.ts ===
const fileToBase64 = (file) => {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => {
            const result = reader.result;
            const base64 = result.split(',')[1];
            resolve({ base64, mimeType: file.type });
        };
        reader.onerror = (error) => reject(error);
    });
};
const createDownloadLink = (blob, fileName) => {
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = fileName;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
};
const downloadTxt = (text) => {
    const blob = new Blob([text], { type: 'text/plain' });
    createDownloadLink(blob, 'document.txt');
};
const downloadDoc = (text) => {
    const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
        "xmlns:w='urn:schemas-microsoft-com:office:word' " +
        "xmlns='http://www.w3.org/TR/REC-html40'>" +
        "<head><meta charset='utf-8'><title>Export HTML to Word Document</title></head><body>";
    const footer = "</body></html>";
    const sourceHTML = header + text.replace(/\n/g, '<br/>') + footer;
    const blob = new Blob([sourceHTML], { type: 'application/msword' });
    createDownloadLink(blob, 'document.doc');
};
const downloadPdf = (text) => {
    try {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const lines = doc.splitTextToSize(text, 180);
        doc.text(lines, 10, 10);
        doc.save('document.pdf');
    }
    catch (e) {
        alert('Failed to create PDF. Please ensure the jsPDF library is loaded correctly.');
        console.error(e);
    }
};
// === END: utils/fileUtils.ts ===


// === START: services/geminiService.ts ===
let ai = null;
let userApiKey = null;
const MISSING_API_KEY_ERROR = "Layanan AI tidak diinisialisasi. Pastikan kunci API Anda dikonfigurasi dengan benar atau berikan satu di aplikasi.";
const INVALID_API_KEY_ERROR = "Kunci API yang Anda berikan tidak valid atau tidak memiliki izin yang benar. Silakan periksa kunci Anda.";
function initializeAIClient() {
    if (ai) {
        return true;
    }
    const key = userApiKey || (typeof process !== 'undefined' && process.env ? process.env.API_KEY : '');
    if (key && key.trim() !== '') {
        try {
            ai = new GoogleGenAI({ apiKey: key });
            return true;
        }
        catch (error) {
            console.error("Gagal menginisialisasi GoogleGenAI:", error);
            ai = null;
            return false;
        }
    }
    return false;
}
function setUserApiKey(apiKey) {
    userApiKey = apiKey;
    ai = null; 
}
async function processImageWithAI(base64Image, mimeType, prompt) {
    if (!initializeAIClient()) {
        throw new Error(MISSING_API_KEY_ERROR);
    }
    const client = ai;
    try {
        const imagePart = {
            inlineData: {
                mimeType: mimeType,
                data: base64Image,
            },
        };
        const textPart = {
            text: prompt,
        };
        const response = await client.models.generateContent({
            model: 'gemini-2.5-flash',
            contents: { parts: [imagePart, textPart] }
        });
        return response.text;
    }
    catch (error) {
        console.error("Error saat memanggil layanan AI:", error);
        if (error instanceof Error && (error.message.toLowerCase().includes('api key') || error.message.toLowerCase().includes('permission denied'))) {
            ai = null;
            throw new Error(INVALID_API_KEY_ERROR);
        }
        throw new Error("Gagal berkomunikasi dengan layanan AI. Silakan coba lagi nanti.");
    }
}
// === END: services/geminiService.ts ===

// === START: components/Icons.tsx ===
const LogoIcon = ({ className }) => (React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 1.5, "aria-labelledby": "logoTitle" },
    React.createElement("title", { id: "logoTitle" }, "Image to Doc Logo"),
    React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" }),
    React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M8 10l2-2 2 2 2.5-2.5" }),
    React.createElement("circle", { cx: "15.5", cy: "8", r: "1.5" }),
    React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M5 13h14" }),
    React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M8 15.5h8M8 18h5" })));
const UploadIcon = ({ className }) => (React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 2 },
    React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" })));
const TxtIcon = ({ className }) => (React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 2 },
    React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" })));
const DocIcon = ({ className }) => (React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 2 },
    React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" })));
const PdfIcon = ({ className }) => (React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 2 },
    React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" })));
const DescriptionIcon = ({ className }) => (React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 2 },
    React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M4 6h16M4 12h16M4 18h7" })));
const TranslateIcon = ({ className }) => (React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 2 },
    React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M3 5h12M9 3v2m1.06 7.16l-1.06-1.06-1.06 1.06M9 16.5V12m0 0a3 3 0 013 3m-3-3a3 3 0 00-3 3m-3.75 3h17.5a2.25 2.25 0 002.25-2.25v-13.5A2.25 2.25 0 0019.25 2H4.75A2.25 2.25 0 002.5 4.25v13.5A2.25 2.25 0 004.75 20z" })));
// === END: components/Icons.tsx ===

// === START: components/Loader.tsx ===
const Loader = () => {
    return (React.createElement("div", { className: "flex justify-center items-center" },
        React.createElement("svg", { className: "animate-spin h-12 w-12 text-sky-400", xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24" },
            React.createElement("circle", { className: "opacity-25", cx: "12", cy: "12", r: "10", stroke: "currentColor", strokeWidth: "4" }),
            React.createElement("path", { className: "opacity-75", fill: "currentColor", d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" }))));
};
// === END: components/Loader.tsx ===

// === START: components/ImageUploader.tsx ===
const ImageUploader = ({ onImageSelect }) => {
    const fileInputRef = useRef(null);
    const [isDragging, setIsDragging] = useState(false);
    const handleFileChange = (event) => {
        const files = event.target.files;
        if (files && files.length > 0) {
            onImageSelect(Array.from(files));
        }
    };
    const handleDrop = useCallback((event) => {
        event.preventDefault();
        event.stopPropagation();
        setIsDragging(false);
        const files = event.dataTransfer.files;
        if (files && files.length > 0) {
            const imageFiles = Array.from(files).filter(file => file.type.startsWith('image/'));
            if (imageFiles.length > 0) {
                onImageSelect(imageFiles);
            }
        }
    }, [onImageSelect]);
    const handleDragOver = (event) => {
        event.preventDefault();
        event.stopPropagation();
        setIsDragging(true);
    };
    const handleDragLeave = (event) => {
        event.preventDefault();
        event.stopPropagation();
        setIsDragging(false);
    };
    const handleClick = () => {
        fileInputRef.current?.click();
    };
    return (React.createElement("div", { onClick: handleClick, onDrop: handleDrop, onDragOver: handleDragOver, onDragLeave: handleDragLeave, className: `group w-full max-w-2xl p-8 sm:p-12 border-4 border-dashed rounded-2xl cursor-pointer transition-all duration-300 bg-white/40 backdrop-blur-lg shadow-lg
      ${isDragging
            ? 'border-fuchsia-500 bg-fuchsia-500/10 scale-105 shadow-2xl shadow-fuchsia-500/20'
            : 'border-slate-400/50 hover:border-fuchsia-400 hover:bg-white/60'
        }` },
        React.createElement("input", { type: "file", ref: fileInputRef, onChange: handleFileChange, className: "hidden", accept: "image/png, image/jpeg, image/webp", multiple: true }),
        React.createElement("div", { className: "flex flex-col items-center justify-center text-center" },
            React.createElement(UploadIcon, { className: "w-16 h-16 text-slate-500 mb-4 transition-transform duration-300 group-hover:text-fuchsia-500 group-hover:scale-110" }),
            React.createElement("p", { className: "text-xl font-semibold text-slate-700" }, "Drag & Drop or Click to Upload"),
            React.createElement("p", { className: "text-slate-500 mt-2" }, "Choose one or more image files (PNG, JPG, WEBP)."))));
};
// === END: components/ImageUploader.tsx ===

// === START: components/ApiKeyInput.tsx ===
const ApiKeyInput = ({ onSubmit, onCancel, initialError }) => {
    const [apiKey, setApiKey] = useState('');
    const [error, setError] = useState(initialError || null);
    const handleSubmit = (e) => {
        e.preventDefault();
        if (!apiKey.trim()) {
            setError("Kunci API tidak boleh kosong.");
            return;
        }
        setError(null);
        onSubmit(apiKey);
    };
    return (React.createElement("div", { className: "text-center bg-white/40 backdrop-blur-lg border border-white/20 p-8 rounded-2xl shadow-lg w-full max-w-md animate-fade-in" },
        React.createElement("h2", { className: "text-2xl font-semibold mb-4 text-sky-700" }, "Diperlukan Kunci API"),
        React.createElement("p", { className: "text-slate-600 mb-6" }, "Kunci API diperlukan untuk menggunakan fitur AI. Silakan masukkan kunci API Google Gemini Anda di bawah ini. Jika Anda tidak memilikinya, Anda bisa mendapatkannya dari Google AI Studio."),
        error && (React.createElement("div", { className: "bg-red-500/20 text-red-700 p-3 rounded-lg mb-4 text-sm" }, error)),
        React.createElement("form", { onSubmit: handleSubmit, className: "flex flex-col gap-4" },
            React.createElement("input", { type: "password", value: apiKey, onChange: (e) => setApiKey(e.target.value), placeholder: "Masukkan Kunci API Gemini Anda", className: "w-full bg-white/60 border-2 border-slate-300 rounded-lg p-3 text-slate-800 focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500 transition-colors", "aria-label": "Input Kunci API Gemini" }),
            React.createElement("div", { className: "flex justify-center gap-4" },
                React.createElement("button", { type: "button", onClick: onCancel, className: "px-6 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold rounded-lg transition-all transform hover:scale-105 shadow-md" }, "Batal"),
                React.createElement("button", { type: "submit", className: "px-6 py-2 bg-gradient-to-r from-sky-500 to-fuchsia-500 hover:opacity-90 text-white font-semibold rounded-lg transition-all transform hover:scale-105 shadow-md" }, "Simpan & Lanjutkan"))),
        React.createElement("style", null, `
                @keyframes fade-in {
                    from { opacity: 0; transform: scale(0.95); }
                    to { opacity: 1; transform: scale(1); }
                }
                .animate-fade-in {
                    animation: fade-in 0.3s ease-out forwards;
                }
            `)));
};
// === END: components/ApiKeyInput.tsx ===

// === START: components/ResultView.tsx ===
const ResultItem = ({ result, onTextChange }) => {
    const triggerAd = () => {
        try {
            const adWindow = window.open('https://niecesprivilegelimelight.com/x1vnqmu9?key=7abbf635479d3bf5a80581864c104b74', '_blank');
            if (!adWindow || adWindow.closed || typeof adWindow.closed === 'undefined') {
                console.warn("Popup ad may have been blocked by the browser.");
            }
        }
        catch (error) {
            console.error("An error occurred while trying to open the popup ad:", error);
        }
    };
    return (React.createElement("div", { className: "bg-white/50 backdrop-blur-md border border-white/30 p-4 rounded-xl flex flex-col md:flex-row gap-4 shadow-md" },
        React.createElement("div", { className: "md:w-1/3 flex-shrink-0" },
            React.createElement("img", { src: result.imageUrl, alt: "Processed content", className: "object-contain w-full h-full max-h-48 md:max-h-full rounded-lg bg-black/5" })),
        React.createElement("div", { className: "flex-grow flex flex-col" },
            React.createElement("textarea", { value: result.text, onChange: (e) => onTextChange(e.target.value), className: "w-full flex-grow bg-white/60 border-2 border-slate-300 rounded-lg p-3 text-slate-800 focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500 transition-colors placeholder:text-slate-500", placeholder: "Result..." }),
            React.createElement("div", { className: "mt-3 flex items-center gap-2" },
                React.createElement("span", { className: "font-semibold text-sm text-slate-600" }, "Download:"),
                React.createElement("button", { onClick: () => { triggerAd(); downloadTxt(result.text); }, className: "download-button border-green-500 text-green-600 hover:bg-green-500 hover:text-white" },
                    React.createElement(TxtIcon, { className: "w-4 h-4" }),
                    " .TXT"),
                React.createElement("button", { onClick: () => { triggerAd(); downloadDoc(result.text); }, className: "download-button border-blue-500 text-blue-600 hover:bg-blue-500 hover:text-white" },
                    React.createElement(DocIcon, { className: "w-4 h-4" }),
                    " .DOC"),
                React.createElement("button", { onClick: () => { triggerAd(); downloadPdf(result.text); }, className: "download-button border-red-500 text-red-600 hover:bg-red-500 hover:text-white" },
                    React.createElement(PdfIcon, { className: "w-4 h-4" }),
                    " .PDF")))));
};
const ResultView = ({ results, onTextChange, onReset, title }) => {
    return (React.createElement("div", { className: "w-full h-full bg-white/40 backdrop-blur-lg border border-white/20 p-4 sm:p-6 rounded-2xl shadow-2xl flex flex-col" },
        React.createElement("div", { className: "flex-shrink-0 mb-4 flex justify-between items-center" },
            React.createElement("h3", { className: "text-xl font-semibold text-fuchsia-600" },
                title,
                " (",
                results.length,
                " item(s))"),
            React.createElement("button", { onClick: onReset, className: "px-6 py-2 bg-gradient-to-r from-sky-500 to-fuchsia-500 hover:opacity-90 text-white font-semibold rounded-lg transition-all transform hover:scale-105 shadow-md" }, "Start Over")),
        React.createElement("div", { className: "flex-grow overflow-y-auto space-y-4 pr-2" }, results.map((result) => (React.createElement(ResultItem, { key: result.id, result: result, onTextChange: (newText) => onTextChange(result.id, newText) })))),
        React.createElement("style", null, `
          .download-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            transition: all 0.2s ease-in-out;
            font-size: 0.875rem;
            font-weight: 500;
            transform-origin: center;
            border-width: 1px;
            background-color: transparent;
          }
          .download-button:hover {
            transform: scale(1.05);
          }
      `)));
};
// === END: components/ResultView.tsx ===

// === START: components/TaskSelector.tsx ===
const TaskSelector = ({ imageUrls, onSelectTask, onCancel }) => {
    const LANGUAGES = [
        { code: 'en', name: 'English' },
        { code: 'es', name: 'Spanish' },
        { code: 'fr', name: 'French' },
        { code: 'de', name: 'German' },
        { code: 'ja', name: 'Japanese' },
        { code: 'id', name: 'Indonesian' },
        { code: 'ru', name: 'Russian' },
        { code: 'zh', name: 'Chinese' },
    ];
    const [language, setLanguage] = useState(LANGUAGES[0].code);
    const triggerAd = () => {
        try {
            const adWindow = window.open('https://niecesprivilegelimelight.com/x1vnqmu9?key=7abbf635479d3bf5a80581864c104b74', '_blank');
            if (!adWindow || adWindow.closed || typeof adWindow.closed === 'undefined') {
                console.warn("Popup ad may have been blocked by the browser.");
            }
        }
        catch (error) {
            console.error("An error occurred while trying to open the popup ad:", error);
        }
    };
    return (React.createElement("div", { className: "w-full max-w-4xl text-center bg-white/40 backdrop-blur-lg border border-white/20 p-6 sm:p-8 rounded-2xl shadow-2xl" },
        React.createElement("h2", { className: "text-2xl sm:text-3xl font-bold text-sky-700 mb-4" }, "Choose a Task"),
        React.createElement("p", { className: "text-slate-600 mb-6" },
            "What would you like to do with these ",
            imageUrls.length,
            " image(s)?"),
        React.createElement("div", { className: "mb-8 p-4 bg-black/5 rounded-lg overflow-hidden" },
            React.createElement("div", { className: "flex overflow-x-auto space-x-4" }, imageUrls.map((url, index) => (React.createElement("img", { key: url, src: url, alt: `Selected for processing ${index + 1}`, className: "flex-shrink-0 h-48 rounded-md object-contain" }))))),
        React.createElement("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
            React.createElement("button", { onClick: () => { triggerAd(); onSelectTask(Task.EXTRACT_TEXT); }, className: "task-button" },
                React.createElement(TxtIcon, { className: "w-8 h-8 mb-2" }),
                React.createElement("span", null, Task.EXTRACT_TEXT)),
            React.createElement("button", { onClick: () => { triggerAd(); onSelectTask(Task.DESCRIBE_IMAGE); }, className: "task-button" },
                React.createElement(DescriptionIcon, { className: "w-8 h-8 mb-2" }),
                React.createElement("span", null, Task.DESCRIBE_IMAGE)),
            React.createElement("div", { className: "md:col-span-2 p-4 bg-white/30 backdrop-blur-sm border border-white/20 rounded-lg flex flex-col sm:flex-row items-center justify-center gap-4" },
                React.createElement(TranslateIcon, { className: "w-8 h-8 text-sky-600" }),
                React.createElement("span", { className: "font-semibold text-slate-700" },
                    Task.TRANSLATE,
                    " to:"),
                React.createElement("select", { value: language, onChange: (e) => setLanguage(e.target.value), className: "bg-white/70 border border-slate-400/50 rounded-md px-3 py-2 text-slate-800 focus:ring-2 focus:ring-sky-500 focus:border-sky-500", "aria-label": "Select language for translation" }, LANGUAGES.map(lang => (React.createElement("option", { key: lang.code, value: lang.code }, lang.name)))),
                React.createElement("button", { onClick: () => { triggerAd(); onSelectTask(Task.TRANSLATE, language); }, className: "px-5 py-2 bg-gradient-to-r from-sky-500 to-fuchsia-500 hover:opacity-90 text-white font-semibold rounded-lg transition-all transform hover:scale-105 shadow-md" }, "Translate"))),
        React.createElement("div", { className: "mt-8" },
            React.createElement("button", { onClick: onCancel, className: "text-slate-500 hover:text-fuchsia-600 transition-colors font-medium" }, "Choose different image(s)")),
        React.createElement("style", null, `
                .task-button {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    padding: 1.5rem;
                    background-color: rgba(255, 255, 255, 0.5);
                    border-radius: 0.75rem;
                    transition: all 0.2s ease-in-out;
                    font-weight: 600;
                    color: #334155; /* slate-700 */
                    border: 1px solid rgba(255, 255, 255, 0.3);
                    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
                }
                .task-button:hover {
                    color: #ffffff;
                    transform: translateY(-5px);
                    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
                    background-image: linear-gradient(to right, var(--tw-gradient-stops));
                    --tw-gradient-from: #0ea5e9; /* sky-500 */
                    --tw-gradient-to: #d946ef;   /* fuchsia-500 */
                    --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);
                }
            `)));
};
// === END: components/TaskSelector.tsx ===

// === START: App.tsx ===
const AdComponent = () => {
    const adRef = useRef(null);
    useEffect(() => {
        const adContainer = adRef.current;
        if (adContainer && adContainer.children.length === 0) {
            const container = document.createElement('div');
            container.id = 'container-10f9d35bcba536c63afb32dc4a986c0d';
            const script = document.createElement('script');
            script.async = true;
            script.setAttribute('data-cfasync', 'false');
            script.src = '//niecesprivilegelimelight.com/10f9d35bcba536c63afb32dc4a986c0d/invoke.js';
            script.onerror = () => {
                if (adContainer) {
                    adContainer.innerHTML = '<div class="text-center text-slate-500 text-sm p-4">Ad could not be loaded. Please disable your ad-blocker.</div>';
                }
            };
            adContainer.appendChild(container);
            adContainer.appendChild(script);
        }
    }, []);
    return (React.createElement("div", { className: "my-6 w-full max-w-5xl mx-auto flex justify-center items-center", ref: adRef, style: { minHeight: '90px' } }));
};
const App = () => {
    const [appState, setAppState] = useState(AppState.IDLE);
    const [imageFiles, setImageFiles] = useState([]);
    const [imageUrls, setImageUrls] = useState([]);
    const [results, setResults] = useState([]);
    const [error, setError] = useState(null);
    const [currentTask, setCurrentTask] = useState(null);
    const [apiKeyError, setApiKeyError] = useState(null);
    const handleTaskSelect = useCallback(async (task, language) => {
        if (imageFiles.length === 0)
            return;
        setCurrentTask(task);
        setAppState(AppState.PROCESSING);
        setError(null);
        setApiKeyError(null);
        let prompt = '';
        switch (task) {
            case Task.EXTRACT_TEXT:
                prompt = "Extract all visible text from this image. Ensure to maintain formatting and line breaks as much as possible. If no text is present, return an empty string.";
                break;
            case Task.DESCRIBE_IMAGE:
                prompt = "Describe this image in detail. What are the main subjects, what is the setting, and what is the overall mood?";
                break;
            case Task.TRANSLATE:
                const languageName = language ? new Intl.DisplayNames(['en'], { type: 'language' }).of(language) : 'the selected language';
                prompt = `First, extract all text from this image. Then, translate the extracted text into ${languageName}. Only return the translated text.`;
                break;
        }
        try {
            const processingPromises = imageFiles.map(async (file) => {
                const { base64, mimeType } = await fileToBase64(file);
                const text = await processImageWithAI(base64, mimeType, prompt);
                return text;
            });
            const processedTexts = await Promise.all(processingPromises);
            const newResults = imageUrls.map((url, index) => ({
                id: url,
                imageUrl: url,
                text: processedTexts[index] || '',
            }));
            setResults(newResults);
            setAppState(AppState.SUCCESS);
        }
        catch (err) {
            console.error(err);
            const errorMessage = err instanceof Error ? err.message : 'An unknown error occurred.';
            if (errorMessage === MISSING_API_KEY_ERROR || errorMessage === INVALID_API_KEY_ERROR) {
                setApiKeyError(errorMessage);
                setAppState(AppState.API_KEY_NEEDED);
            }
            else {
                setError(errorMessage);
                setAppState(AppState.ERROR);
            }
        }
    }, [imageFiles, imageUrls]);
    const handleImageSelect = useCallback((files) => {
        const urls = files.map(file => URL.createObjectURL(file));
        setImageFiles(files);
        setImageUrls(urls);
        setAppState(AppState.TASK_SELECTION);
    }, []);
    const handleReset = () => {
        setAppState(AppState.IDLE);
        setImageFiles([]);
        setResults([]);
        setError(null);
        setApiKeyError(null);
        setCurrentTask(null);
        if (imageUrls.length > 0) {
            imageUrls.forEach(url => URL.revokeObjectURL(url));
            setImageUrls([]);
        }
    };
    const handleApiKeySubmit = useCallback((apiKey) => {
        setUserApiKey(apiKey);
        setAppState(AppState.TASK_SELECTION);
        setApiKeyError(null);
    }, []);
    const handleResultTextChange = (id, newText) => {
        setResults(prevResults => prevResults.map(result => result.id === id ? { ...result, text: newText } : result));
    };
    const getResultTitle = () => {
        if (!currentTask)
            return "Result";
        switch (currentTask) {
            case Task.EXTRACT_TEXT:
                return "Extracted Text (Editable)";
            case Task.DESCRIBE_IMAGE:
                return "Image Description (Editable)";
            case Task.TRANSLATE:
                return "Translated Text (Editable)";
            default:
                return "Result (Editable)";
        }
    };
    const renderContent = () => {
        switch (appState) {
            case AppState.TASK_SELECTION:
                return (imageUrls.length > 0 && React.createElement(TaskSelector, { imageUrls: imageUrls, onSelectTask: handleTaskSelect, onCancel: handleReset }));
            case AppState.PROCESSING:
                return (React.createElement("div", { className: "text-center bg-white/40 backdrop-blur-lg border border-white/20 p-8 rounded-2xl shadow-lg" },
                    React.createElement("h2", { className: "text-2xl font-semibold mb-4 text-fuchsia-600" }, currentTask ? `Processing ${imageFiles.length} image(s): ${currentTask}...` : 'Analyzing...'),
                    React.createElement("div", { className: "flex flex-wrap justify-center gap-4 max-h-64 overflow-y-auto p-2 bg-black/5 rounded-lg" }, imageUrls.map(url => React.createElement("img", { key: url, src: url, alt: "Preview", className: "h-24 rounded-lg shadow-md" }))),
                    React.createElement(Loader, null),
                    React.createElement("p", { className: "text-slate-600 mt-4 animate-pulse" }, "Artificial intelligence is working on your request.")));
            case AppState.SUCCESS:
                return (React.createElement(ResultView, { results: results, onTextChange: handleResultTextChange, onReset: handleReset, title: getResultTitle() }));
            case AppState.API_KEY_NEEDED:
                return (React.createElement(ApiKeyInput, { onSubmit: handleApiKeySubmit, onCancel: handleReset, initialError: apiKeyError }));
            case AppState.ERROR:
                return (React.createElement("div", { className: "text-center bg-red-500/10 backdrop-blur-sm border border-red-500/50 p-8 rounded-2xl shadow-xl" },
                    React.createElement("h2", { className: "text-2xl font-semibold mb-4 text-red-600" }, "Processing Failed"),
                    React.createElement("p", { className: "text-slate-700 mb-6" }, error),
                    React.createElement("button", { onClick: handleReset, className: "px-6 py-2 bg-gradient-to-r from-sky-500 to-fuchsia-500 hover:opacity-90 text-white font-semibold rounded-lg transition-all transform hover:scale-105 shadow-md" }, "Try Again")));
            case AppState.IDLE:
            default:
                return (React.createElement(ImageUploader, { onImageSelect: handleImageSelect }));
        }
    };
    return (React.createElement("div", { className: "min-h-screen w-full flex flex-col items-center justify-center p-4 sm:p-6 lg:p-8" },
        React.createElement("header", { className: "w-full max-w-5xl mx-auto text-center mb-8" },
            React.createElement("div", { className: "flex justify-center items-center gap-x-3 sm:gap-x-4" },
                React.createElement(LogoIcon, { className: "w-10 h-10 sm:w-12 sm:h-12 text-sky-500" }),
                React.createElement("h1", { className: "text-4xl sm:text-5xl font-bold tracking-wider text-transparent bg-clip-text bg-gradient-to-r from-fuchsia-600 via-purple-600 to-sky-500 font-orbitron" }, "Image to Doc")),
            React.createElement("p", { className: "text-slate-600 mt-3 text-lg font-semibold" }, "Instantly convert your images to editable documents. Extract, describe, and translate text with AI.")),
        React.createElement(AdComponent, null),
        appState === AppState.IDLE && (React.createElement("section", { className: "w-full max-w-5xl mx-auto mb-10 px-4" },
            React.createElement("div", { className: "bg-white/40 backdrop-blur-lg border border-white/20 rounded-2xl p-6 sm:p-8 shadow-lg" },
                React.createElement("h2", { className: "text-2xl font-bold text-sky-700 mb-4" }, "Your Image-to-Document Companion"),
                React.createElement("p", { className: "text-slate-700 mb-6" }, "Unlock the full potential of your images. This application uses advanced AI to perform multiple tasks: extract text for easy editing, generate rich descriptions of scenes, and even translate text found in images to other languages."),
                React.createElement("div", { className: "grid md:grid-cols-2 gap-x-8 gap-y-6" },
                    React.createElement("div", null,
                        React.createElement("h3", { className: "text-xl font-semibold text-sky-600 mb-2" }, "Key Features"),
                        React.createElement("ul", { className: "list-disc list-inside text-slate-600 space-y-1" },
                            React.createElement("li", null,
                                React.createElement("strong", null, "Extract Text:"),
                                " High-accuracy text extraction."),
                            React.createElement("li", null,
                                React.createElement("strong", null, "Describe Image:"),
                                " Get a detailed description of your image."),
                            React.createElement("li", null,
                                React.createElement("strong", null, "Translate Text:"),
                                " Translate text within images to multiple languages."),
                            React.createElement("li", null,
                                React.createElement("strong", null, "Edit & Export:"),
                                " Edit results and download as TXT, DOC, or PDF."))),
                    React.createElement("div", null,
                        React.createElement("h3", { className: "text-xl font-semibold text-sky-600 mb-2" }, "How to Use"),
                        React.createElement("ol", { className: "list-decimal list-inside text-slate-600 space-y-1" },
                            React.createElement("li", null,
                                React.createElement("strong", null, "Upload Image(s):"),
                                " Select one or more image files to get started."),
                            React.createElement("li", null,
                                React.createElement("strong", null, "Choose a Task:"),
                                " Pick from extracting text, describing, or translating."),
                            React.createElement("li", null,
                                React.createElement("strong", null, "Review & Edit:"),
                                " The AI-generated results will appear. Make any edits you need."),
                            React.createElement("li", null,
                                React.createElement("strong", null, "Download:"),
                                " Save your work in your desired format."))))))),
        React.createElement("main", { className: "w-full max-w-5xl mx-auto flex-grow flex items-center justify-center" }, renderContent()),
        React.createElement("footer", { className: "w-full text-center p-4 mt-8 text-slate-500" }, "Powered by Generative AI")));
};
// === END: App.tsx ===

// === START: index.tsx ===
const rootElement = document.getElementById('root');
if (!rootElement) {
    throw new Error("Could not find root element to mount to");
}
const root = ReactDOM.createRoot(rootElement);
root.render(React.createElement(React.StrictMode, null,
    React.createElement(App, null)));
// === END: index.tsx ===

    </script>
  </body>
</html>